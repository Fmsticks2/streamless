{"version":3,"file":"bignum.js","sourceRoot":"","sources":["../../../src/serializers/bignum.ts"],"names":[],"mappings":"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","sourcesContent":["import { U64_MAX } from './numbers'\n\n/**\n * The maximum value for an unsigned 128-bit integer (u128) represented as a BigInt.\n */\nexport const U128_MAX = BigInt('0xffffffffffffffffffffffffffffffff')\n\n/**\n * The maximum value for an unsigned 256-bit integer (u256) represented as a BigInt.\n */\nexport const U256_MAX = BigInt(\n  '0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff'\n)\n\n/**\n * The maximum value for a signed 128-bit integer (i128) represented as a BigInt.\n */\nexport const I128_MAX = BigInt('0x7fffffffffffffffffffffffffffffff')\n\n/**\n * The minimum value for a signed 128-bit integer (i128) represented as a BigInt.\n */\nexport const I128_MIN = BigInt('-170141183460469231731687303715884105728')\n\nfunction generic128ToBytes(val: bigint): Uint8Array {\n  const upper = val >> 64n\n  const lower = (val << 64n) >> 64n\n\n  const buffer = new ArrayBuffer(16)\n  const view = new DataView(buffer)\n\n  view.setBigUint64(0, lower, true)\n  view.setBigUint64(8, upper, true)\n\n  return new Uint8Array(view.buffer)\n}\n\n/**\n * Converts an unsigned 128-bit integer (u128) BigInt into a Uint8Array.\n *\n * @param val - The BigInt to convert\n *\n * @throws Will throw an error if the input value is not within the valid u128 range (0 to 340282366920938463463374607431768211455)\n *\n * @returns A Uint8Array containing the serialized u128 BigInt value\n *\n */\nexport function u128ToBytes(val: bigint): Uint8Array {\n  if (val < 0 || val > U128_MAX) {\n    throw new Error(`Unable to serialize invalid Uint128 value ${val}`)\n  }\n\n  return generic128ToBytes(val)\n}\n\n/**\n * Converts a Uint8Array into an unsigned 128-bit integer (u128) BigInt.\n *\n * @param arr - The array to convert\n * @param offset - The optional offset in the Uint8Array at which to start reading the u128 value (default: 0)\n *\n * @returns The deserialized u128BigInt value\n *\n */\nexport function bytesToU128(arr: Uint8Array, offset = 0): bigint {\n  const view = new DataView(arr.buffer, offset)\n\n  const lower = view.getBigUint64(0, true) // Lower 64 bits\n  const upper = view.getBigUint64(8, true) // Upper 64 bits\n\n  return (upper << 64n) | lower\n}\n\n/**\n * Converts a signed 128-bit integer (i128) BigInt into a Uint8Array.\n *\n * @param val - The BigInt to convert\n *\n * @throws Will throw an error if the input value is not within the valid u128 range (0 to 340282366920938463463374607431768211455)\n *\n * @returns A Uint8Array containing the serialized u128 BigInt value\n *\n */\nexport function i128ToBytes(val: bigint): Uint8Array {\n  if (val < I128_MIN || val > I128_MAX) {\n    throw new Error(`Unable to serialize invalid Int128 value ${val}`)\n  }\n  return generic128ToBytes(val)\n}\n\n/**\n * Converts a Uint8Array into a signed 128-bit integer (i128) BigInt.\n *\n * @param arr - The array to convert\n * @param offset - The optional offset in the Uint8Array at which to start reading the i128 value (default: 0)\n *\n * @returns The deserialized i128 BigInt value\n *\n */\nexport function bytesToI128(arr: Uint8Array, offset = 0): bigint {\n  const view = new DataView(arr.buffer, offset)\n\n  const lower = view.getBigUint64(0, true) // Lower 64 bits\n  const upper = view.getBigInt64(8, true) // Upper 64 bits\n\n  return (upper << 64n) | lower\n}\n\n/**\n * Converts an unsigned 256-bit integer (u256) BigInt into a Uint8Array.\n *\n * @param val - The BigInt to convert\n *\n * @throws Will throw an error if the input value is not within the valid u256 range (0 to 340282366920938463463374607431768211455)\n *\n * @returns A Uint8Array containing the serialized u256 BigInt value\n *\n */\nexport function u256ToBytes(val: bigint): Uint8Array {\n  if (val < 0 || val > U256_MAX) {\n    throw new Error(`Unable to serialize invalid Uint256 value ${val}`)\n  }\n\n  const p0 = val & U64_MAX\n  const p1 = (val >> 64n) & U64_MAX\n  const p2 = (val >> 128n) & U64_MAX\n  const p3 = (val >> 192n) & U64_MAX\n\n  const buffer = new ArrayBuffer(32)\n  const view = new DataView(buffer)\n\n  view.setBigUint64(0, p0, true)\n  view.setBigUint64(8, p1, true)\n  view.setBigUint64(16, p2, true)\n  view.setBigUint64(24, p3, true)\n\n  return new Uint8Array(view.buffer)\n}\n\n/**\n * Converts a Uint8Array into an unsigned 256-bit integer (u256) BigInt.\n *\n * @param arr - The array to convert\n * @param offset - The optional offset in the Uint8Array at which to start reading the u256 value (default: 0)\n *\n * @returns The deserialized u256BigInt value\n *\n */\nexport function bytesToU256(arr: Uint8Array, offset = 0): bigint {\n  const view = new DataView(arr.buffer, offset)\n\n  const p0 = view.getBigUint64(0, true)\n  const p1 = view.getBigUint64(8, true)\n  const p2 = view.getBigUint64(16, true)\n  const p3 = view.getBigUint64(24, true)\n\n  return (p3 << 192n) | (p2 << 128n) | (p1 << 64n) | p0\n}\n"]}