{"version":3,"file":"retryExecuteFunction.js","sourceRoot":"","sources":["../../../src/utils/retryExecuteFunction.ts"],"names":[],"mappings":";;;AACA,iCAA8B;AAE9B,MAAM,mBAAmB,GAAG,CAAC,CAAC;AAC9B,MAAM,iBAAiB,GAAG,GAAG,CAAC;AAO9B;;;;;;;;;;GAUG;AACI,MAAM,cAAc,GAAG,KAAK,EACjC,IAAyB,EACzB,IAAwC,EACxC,aAAqB,mBAAmB,EAC5B,EAAE;IACd,IAAI,GAAG,IAAI,IAAI,CAAC,IAAI,EAAE,EAAE,CAAC,CAAC;IAE1B,IAAI,CAAC,IAAI;QACP,MAAM,IAAI,KAAK,CACb,qDAAqD,IAAI,EAAE,CAC5D,CAAC;IAEJ,IAAI,cAAc,GAAG,CAAC,CAAC;IACvB,IAAI,GAAG,GAAM,IAAI,CAAC;IAClB,OAAO,IAAI,EAAE;QACX,IAAI;YACF,GAAG,GAAG,MAAM,IAAI,CAAC,GAAG,IAAI,CAAC,CAAC;YAC1B,MAAM;SACP;QAAC,OAAO,EAAE,EAAE;YACX,EAAE,cAAc,CAAC;YACjB,MAAM,GAAG,GAAG,8BAA8B,IAAI,CAAC,IAAI,kBAAkB,cAAc,cAAc,iBAAiB,KAAK,CAAC;YACxH,OAAO,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;YACnB,MAAM,IAAA,WAAI,EAAC,iBAAiB,CAAC,CAAC;YAE9B,IAAI,cAAc,KAAK,UAAU,EAAE;gBACjC,MAAM,EAAE,CAAC;aACV;SACF;KACF;IACD,OAAO,GAAG,CAAC;AACb,CAAC,CAAC;AA9BW,QAAA,cAAc,kBA8BzB","sourcesContent":["import { JSON_RPC_REQUEST_METHOD } from '../interfaces/JsonRpcMethods';\nimport { wait } from './time';\n\nconst MAX_NUMBER_RETRIALS = 5;\nconst RETRY_INTERVAL_MS = 300;\n\ntype CallbackFunction<R> = (\n  resource: JSON_RPC_REQUEST_METHOD,\n  params: object,\n) => Promise<R>;\n\n/**\n * Tries to execute a function and retries if it fails.\n *\n * @param func - The function to execute\n * @param args - The arguments to pass to the function (optional)\n * @param retryTimes - The number of times to retry (default: 5)\n *\n * @throws If the function is not defined or if it fails after the number of retries\n *\n * @returns The result of the function upon successful execution\n */\nexport const trySafeExecute = async <R>(\n  func: CallbackFunction<R>,\n  args?: [JSON_RPC_REQUEST_METHOD, object],\n  retryTimes: number = MAX_NUMBER_RETRIALS,\n): Promise<R> => {\n  args = args || [null, {}];\n\n  if (!func)\n    throw new Error(\n      `Function execution init conditions are erroneous: ${func}`,\n    );\n\n  let failureCounter = 0;\n  let res: R = null;\n  while (true) {\n    try {\n      res = await func(...args);\n      break;\n    } catch (ex) {\n      ++failureCounter;\n      const msg = `Failed to execute function ${func.name}. Retrying for ${failureCounter}th time in ${RETRY_INTERVAL_MS}ms.`;\n      console.error(msg);\n      await wait(RETRY_INTERVAL_MS);\n\n      if (failureCounter === retryTimes) {\n        throw ex;\n      }\n    }\n  }\n  return res;\n};\n"]}