{"version":3,"file":"PrivateApiClient.js","sourceRoot":"","sources":["../../../src/web3/PrivateApiClient.ts"],"names":[],"mappings":"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","sourcesContent":["import { IClientConfig } from '../interfaces/IClientConfig';\nimport { trySafeExecute } from '../utils/retryExecuteFunction';\nimport { JSON_RPC_REQUEST_METHOD } from '../interfaces/JsonRpcMethods';\nimport { ISignedMessage } from '../interfaces/ISignedMessage';\nimport { BaseClient } from './BaseClient';\nimport { IPrivateApiClient } from '../interfaces/IPrivateApiClient';\n\n/**\n * Private Api Client for interacting with a massa node.\n */\nexport class PrivateApiClient extends BaseClient implements IPrivateApiClient {\n  /**\n   * Constructor for the {@link PrivateApiClient} object.\n   *\n   * @param clientConfig - The client configuration.\n   */\n  public constructor(clientConfig: IClientConfig) {\n    super(clientConfig);\n\n    // ========== bind api methods ========= //\n\n    // private api methods\n    this.nodeStop = this.nodeStop.bind(this);\n    this.nodeBanById = this.nodeBanById.bind(this);\n    this.nodeBanByIpAddress = this.nodeBanByIpAddress.bind(this);\n    this.nodeUnbanById = this.nodeUnbanById.bind(this);\n    this.nodeUnbanByIpAddress = this.nodeUnbanByIpAddress.bind(this);\n    this.nodeAddStakingSecretKeys = this.nodeAddStakingSecretKeys.bind(this);\n    this.nodeGetStakingAddresses = this.nodeGetStakingAddresses.bind(this);\n    this.nodeRemoveStakingAddresses =\n      this.nodeRemoveStakingAddresses.bind(this);\n    this.nodeSignMessage = this.nodeSignMessage.bind(this);\n    this.nodeRemoveFromWhitelist = this.nodeRemoveFromWhitelist.bind(this);\n    this.nodeAddToPeersWhitelist = this.nodeAddToPeersWhitelist.bind(this);\n  }\n\n  /**\n   * Add a given Node IP address from the whitelist.\n   *\n   * @param ipAddress - The IP address to add to the whitelist.\n   *\n   * @returns A promise that resolves when the request is complete.\n   */\n  public async nodeAddToPeersWhitelist(ipAddress: string): Promise<void> {\n    const jsonRpcRequestMethod =\n      JSON_RPC_REQUEST_METHOD.NODE_ADD_TO_PEERS_WHITELIST;\n    if (this.clientConfig.retryStrategyOn) {\n      return await trySafeExecute<void>(this.sendJsonRPCRequest, [\n        jsonRpcRequestMethod,\n        [[ipAddress]],\n      ]);\n    } else {\n      return await this.sendJsonRPCRequest<void>(jsonRpcRequestMethod, [\n        [ipAddress],\n      ]);\n    }\n  }\n\n  /**\n   * Remove a given Node IP address from the whitelist.\n   *\n   * @param ipAddress - The IP address to remove from the whitelist.\n   *\n   * @returns A promise that resolves when the request is complete.\n   */\n  public async nodeRemoveFromWhitelist(ipAddress: string): Promise<void> {\n    const jsonRpcRequestMethod =\n      JSON_RPC_REQUEST_METHOD.NODE_REMOVE_FROM_WHITELIST;\n    if (this.clientConfig.retryStrategyOn) {\n      return await trySafeExecute<void>(this.sendJsonRPCRequest, [\n        jsonRpcRequestMethod,\n        [[ipAddress]],\n      ]);\n    } else {\n      return await this.sendJsonRPCRequest<void>(jsonRpcRequestMethod, [\n        [ipAddress],\n      ]);\n    }\n  }\n\n  /**\n   * Unban a given IP address.\n   *\n   * @param ipAddress - The IP address to unban.\n   *\n   * @returns A promise that resolves when the request is complete.\n   */\n  public async nodeUnbanByIpAddress(ipAddress: string): Promise<void> {\n    const jsonRpcRequestMethod = JSON_RPC_REQUEST_METHOD.NODE_UNBAN_BY_IP;\n    if (this.clientConfig.retryStrategyOn) {\n      return await trySafeExecute<void>(this.sendJsonRPCRequest, [\n        jsonRpcRequestMethod,\n        [[ipAddress]],\n      ]);\n    } else {\n      return await this.sendJsonRPCRequest<void>(jsonRpcRequestMethod, [\n        [ipAddress],\n      ]);\n    }\n  }\n\n  /**\n   * Unban a given node id.\n   *\n   * @param nodeId - The node id to unban.\n   * @returns A promise that resolves when the request is complete.\n   */\n  public async nodeUnbanById(nodeId: string): Promise<void> {\n    const jsonRpcRequestMethod = JSON_RPC_REQUEST_METHOD.NODE_UNBAN_BY_ID;\n    if (this.clientConfig.retryStrategyOn) {\n      return await trySafeExecute<void>(this.sendJsonRPCRequest, [\n        jsonRpcRequestMethod,\n        [[nodeId]],\n      ]);\n    } else {\n      return await this.sendJsonRPCRequest<void>(jsonRpcRequestMethod, [\n        [nodeId],\n      ]);\n    }\n  }\n\n  /**\n   * Ban a given node IP address.\n   *\n   * @param ipAddress - The IP address to ban.\n   * @returns A promise that resolves when the request is complete.\n   */\n  public async nodeBanByIpAddress(ipAddress: string): Promise<void> {\n    const jsonRpcRequestMethod = JSON_RPC_REQUEST_METHOD.NODE_BAN_BY_IP;\n    if (this.clientConfig.retryStrategyOn) {\n      return await trySafeExecute<void>(this.sendJsonRPCRequest, [\n        jsonRpcRequestMethod,\n        [[ipAddress]],\n      ]);\n    } else {\n      return await this.sendJsonRPCRequest<void>(jsonRpcRequestMethod, [\n        [ipAddress],\n      ]);\n    }\n  }\n\n  /**\n   * Ban a given node Id.\n   *\n   * @param id - The node id to ban.\n   *\n   * @returns A promise that resolves when the request is complete.\n   */\n  public async nodeBanById(id: string): Promise<void> {\n    const jsonRpcRequestMethod = JSON_RPC_REQUEST_METHOD.NODE_BAN_BY_ID;\n    if (this.clientConfig.retryStrategyOn) {\n      return await trySafeExecute<void>(this.sendJsonRPCRequest, [\n        jsonRpcRequestMethod,\n        [[id]],\n      ]);\n    } else {\n      return await this.sendJsonRPCRequest<void>(jsonRpcRequestMethod, [[id]]);\n    }\n  }\n\n  /**\n   * Stops the node.\n   *\n   * @returns A promise that resolves when the request is complete.\n   */\n  public async nodeStop(): Promise<void> {\n    const jsonRpcRequestMethod = JSON_RPC_REQUEST_METHOD.STOP_NODE;\n    if (this.clientConfig.retryStrategyOn) {\n      return await trySafeExecute<void>(this.sendJsonRPCRequest, [\n        jsonRpcRequestMethod,\n        [],\n      ]);\n    } else {\n      return await this.sendJsonRPCRequest<void>(jsonRpcRequestMethod, []);\n    }\n  }\n\n  /**\n   * Node signs a message.\n   *\n   * @param message - The message to sign.\n   *\n   * @returns A promise that resolves to an ISignedMessage object.\n   */\n  public async nodeSignMessage(message: Uint8Array): Promise<ISignedMessage> {\n    const jsonRpcRequestMethod = JSON_RPC_REQUEST_METHOD.NODE_SIGN_MESSAGE;\n    if (this.clientConfig.retryStrategyOn) {\n      return await trySafeExecute<ISignedMessage>(this.sendJsonRPCRequest, [\n        jsonRpcRequestMethod,\n        [message],\n      ]);\n    } else {\n      return await this.sendJsonRPCRequest<ISignedMessage>(\n        jsonRpcRequestMethod,\n        [message],\n      );\n    }\n  }\n\n  /**\n   * Get staking addresses.\n   *\n   * @returns A promise that resolves to an array of addresses (strings).\n   */\n  public async nodeGetStakingAddresses(): Promise<Array<string>> {\n    const jsonRpcRequestMethod = JSON_RPC_REQUEST_METHOD.GET_STAKING_ADDRESSES;\n    if (this.clientConfig.retryStrategyOn) {\n      return await trySafeExecute<Array<string>>(this.sendJsonRPCRequest, [\n        jsonRpcRequestMethod,\n        [],\n      ]);\n    } else {\n      return await this.sendJsonRPCRequest<Array<string>>(\n        jsonRpcRequestMethod,\n        [],\n      );\n    }\n  }\n\n  /**\n   * Remove staking addresses.\n   *\n   * @param addresses - The addresses to remove.\n   *\n   * @returns A promise that resolves when the request is complete.\n   */\n  public async nodeRemoveStakingAddresses(\n    addresses: Array<string>,\n  ): Promise<void> {\n    const jsonRpcRequestMethod =\n      JSON_RPC_REQUEST_METHOD.REMOVE_STAKING_ADDRESSES;\n    if (this.clientConfig.retryStrategyOn) {\n      return await trySafeExecute<void>(this.sendJsonRPCRequest, [\n        jsonRpcRequestMethod,\n        [addresses],\n      ]);\n    } else {\n      return await this.sendJsonRPCRequest<void>(jsonRpcRequestMethod, [\n        addresses,\n      ]);\n    }\n  }\n\n  /**\n   * Add staking private keys.\n   *\n   * @param secretKeys - The secret keys to add.\n   *\n   * @returns A promise that resolves when the request is complete.\n   */\n  public async nodeAddStakingSecretKeys(\n    secretKeys: Array<string>,\n  ): Promise<void> {\n    const jsonRpcRequestMethod =\n      JSON_RPC_REQUEST_METHOD.ADD_STAKING_PRIVATE_KEYS;\n    if (this.clientConfig.retryStrategyOn) {\n      return await trySafeExecute<void>(this.sendJsonRPCRequest, [\n        jsonRpcRequestMethod,\n        [secretKeys],\n      ]);\n    } else {\n      return await this.sendJsonRPCRequest<void>(jsonRpcRequestMethod, [\n        secretKeys,\n      ]);\n    }\n  }\n}\n"]}