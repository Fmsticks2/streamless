{"version":3,"file":"BaseClient.js","sourceRoot":"","sources":["../../../src/web3/BaseClient.ts"],"names":[],"mappings":"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","sourcesContent":["import { IProvider, ProviderType } from '../interfaces/IProvider';\nimport { IClientConfig } from '../interfaces/IClientConfig';\nimport { Buffer } from 'buffer';\nimport { base58Decode, varintEncode } from '../utils/Xbqcrypto';\nimport { IContractData } from '../interfaces/IContractData';\nimport { JsonRpcResponseData } from '../interfaces/JsonRpcResponseData';\nimport axios, { AxiosResponse, AxiosRequestHeaders } from 'axios';\nimport { JSON_RPC_REQUEST_METHOD } from '../interfaces/JsonRpcMethods';\nimport { ITransactionData } from '../interfaces/ITransactionData';\nimport { OperationTypeId } from '../interfaces/OperationTypes';\nimport { IRollsData } from '../interfaces/IRollsData';\nimport { ICallData } from '../interfaces/ICallData';\n\n// encode a string address to bytes.\nconst encodeAddressToBytes = (\n  address: string,\n  isSmartContract = false,\n): Buffer => {\n  let targetAddressEncoded = base58Decode(address.slice(2));\n  targetAddressEncoded = Buffer.concat([\n    isSmartContract ? Buffer.from([1]) : Buffer.from([0]),\n    targetAddressEncoded,\n  ]);\n\n  return targetAddressEncoded;\n};\n\nexport type DataType =\n  | IContractData\n  | ITransactionData\n  | IRollsData\n  | ICallData;\n\nexport const requestHeaders = {\n  Accept:\n    'application/json,text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8',\n  'Access-Control-Allow-Origin': '*',\n  'Access-Control-Allow-Credentials': true,\n  'Access-Control-Allow-Methods': 'GET,PUT,POST,DELETE,PATCH,OPTIONS',\n} as AxiosRequestHeaders;\n\nexport const PERIOD_OFFSET = 5;\n\n/**\n * The Base Client object is the main entry point for interacting with the massa blockchain.\n *\n * @remarks\n * The `BaseClient` class should not be instantiated directly; instead, it should\n * be extended by other client classes to provide additional functionality on top of the core\n * methods provided by this class.\n *\n * @throws Will throw an error if no public providers are included in client configuration.\n * @throws Will throw an error if no private providers are included in client configuration.\n */\nexport class BaseClient {\n  public clientConfig: IClientConfig;\n\n  /**\n   * Constructor of the BaseClient class\n   *\n   * @param clientConfig - The client configuration object as defined in {@link IClientConfig}\n   */\n  public constructor(clientConfig: IClientConfig) {\n    this.clientConfig = clientConfig;\n    this.clientConfig.periodOffset =\n      this.clientConfig.periodOffset | PERIOD_OFFSET;\n    if (this.getPublicProviders().length === 0) {\n      throw new Error(\n        'Cannot initialize web3 with no public providers. Need at least one',\n      );\n    }\n\n    // bind class methods\n    this.getPrivateProviders = this.getPrivateProviders.bind(this);\n    this.getProviderForRpcMethod = this.getProviderForRpcMethod.bind(this);\n    this.getPublicProviders = this.getPublicProviders.bind(this);\n    this.sendJsonRPCRequest = this.sendJsonRPCRequest.bind(this);\n    this.compactBytesForOperation = this.compactBytesForOperation.bind(this);\n    this.setProviders = this.setProviders.bind(this);\n    this.promisifyJsonRpcCall = this.promisifyJsonRpcCall.bind(this);\n  }\n\n  /**\n   * Set new providers as {@link IProvider}.\n   *\n   * @privateRemarks\n   * This methods add the providers to the existing ones in the clientConfig object.\n   *\n   * @param providers - The new providers to set as an array of IProvider.\n   *\n   * @throws Will throw an error if no public providers are included in the given array of providers.\n   * @throws Will throw an error if no private providers are included in the given array of providers.\n   */\n  public setProviders(providers: Array<IProvider>): void {\n    const hasPublicProvider = providers.some(\n      (provider) => provider.type === ProviderType.PUBLIC,\n    );\n\n    if (!hasPublicProvider) {\n      throw new Error(\n        'Cannot set providers with no public providers. Need at least one',\n      );\n    }\n\n    this.clientConfig.providers = providers;\n  }\n\n  /**\n   * Returns all the private providers.\n   *\n   * @returns An array of IProvider containing all the private providers.\n   */\n  protected getPrivateProviders(): Array<IProvider> {\n    return this.clientConfig.providers.filter(\n      (provider) => provider.type === ProviderType.PRIVATE,\n    );\n  }\n\n  /**\n   * Returns all the public providers.\n   *\n   * @returns An array of IProvider containing all the public providers.\n   */\n  protected getPublicProviders(): Array<IProvider> {\n    return this.clientConfig.providers.filter(\n      (provider) => provider.type === ProviderType.PUBLIC,\n    );\n  }\n\n  /**\n   * Find provider for a concrete rpc method\n   *\n   * @remarks\n   * This method chooses the provider to use for a given rpc method.\n   *  - If the rpc method is about getting or sending data to the blockchain,\n   *    it will choose a public provider.\n   *  - If the rpc method is meant to be used by the node itself, it will choose a private provider.\n   *  - An error is thrown if no provider is found for the rpc method.\n   *\n   * @param requestMethod - The rpc method to find the provider for.\n   *\n   * @returns The provider for the rpc method.\n   */\n  private getProviderForRpcMethod(\n    requestMethod: JSON_RPC_REQUEST_METHOD,\n  ): IProvider {\n    switch (requestMethod) {\n      case JSON_RPC_REQUEST_METHOD.GET_ADDRESSES:\n      case JSON_RPC_REQUEST_METHOD.GET_STATUS:\n      case JSON_RPC_REQUEST_METHOD.SEND_OPERATIONS:\n      case JSON_RPC_REQUEST_METHOD.GET_OPERATIONS:\n      case JSON_RPC_REQUEST_METHOD.GET_BLOCKS:\n      case JSON_RPC_REQUEST_METHOD.GET_ENDORSEMENTS:\n      case JSON_RPC_REQUEST_METHOD.GET_CLIQUES:\n      case JSON_RPC_REQUEST_METHOD.GET_STAKERS:\n      case JSON_RPC_REQUEST_METHOD.GET_FILTERED_SC_OUTPUT_EVENT:\n      case JSON_RPC_REQUEST_METHOD.EXECUTE_READ_ONLY_BYTECODE:\n      case JSON_RPC_REQUEST_METHOD.EXECUTE_READ_ONLY_CALL:\n      case JSON_RPC_REQUEST_METHOD.GET_DATASTORE_ENTRIES:\n      case JSON_RPC_REQUEST_METHOD.GET_BLOCKCLIQUE_BLOCK_BY_SLOT:\n      case JSON_RPC_REQUEST_METHOD.GET_GRAPH_INTERVAL: {\n        let providers = this.getPublicProviders();\n        let idx = Math.floor(Math.random() * providers.length);\n        return providers[idx];\n      }\n      case JSON_RPC_REQUEST_METHOD.STOP_NODE:\n      case JSON_RPC_REQUEST_METHOD.NODE_BAN_BY_ID:\n      case JSON_RPC_REQUEST_METHOD.NODE_BAN_BY_IP:\n      case JSON_RPC_REQUEST_METHOD.NODE_UNBAN_BY_ID:\n      case JSON_RPC_REQUEST_METHOD.NODE_UNBAN_BY_IP:\n      case JSON_RPC_REQUEST_METHOD.GET_STAKING_ADDRESSES:\n      case JSON_RPC_REQUEST_METHOD.REMOVE_STAKING_ADDRESSES:\n      case JSON_RPC_REQUEST_METHOD.ADD_STAKING_PRIVATE_KEYS:\n      case JSON_RPC_REQUEST_METHOD.NODE_SIGN_MESSAGE:\n      case JSON_RPC_REQUEST_METHOD.NODE_REMOVE_FROM_WHITELIST: {\n        let providers = this.getPrivateProviders();\n        let idx = Math.floor(Math.random() * providers.length);\n        return providers[idx];\n      }\n      default:\n        throw new Error(`Unknown Json rpc method: ${requestMethod}`);\n    }\n  }\n\n  /**\n   * Converts a json rpc call to a promise that resolves as a JsonRpcResponseData\n   *\n   * @privateRemarks\n   * If there is an error while sending the request, the function catches the error, the isError\n   * property is set to true, the result property set to null, and the error property set to a\n   * new Error object with a message indicating that there was an error.\n   *\n   * @param resource - The rpc method to call.\n   * @param params - The parameters to pass to the rpc method.\n   *\n   * @returns A promise that resolves as a JsonRpcResponseData.\n   */\n  private async promisifyJsonRpcCall<T>(\n    resource: JSON_RPC_REQUEST_METHOD,\n    params: object,\n  ): Promise<JsonRpcResponseData<T>> {\n    let resp: AxiosResponse<JsonRpcResponseData<T>> = null;\n\n    const body = {\n      jsonrpc: '2.0',\n      method: resource,\n      params: params,\n      id: 0,\n    };\n\n    try {\n      resp = await axios.post(\n        this.getProviderForRpcMethod(resource).url,\n        body,\n        requestHeaders,\n      );\n    } catch (ex) {\n      return {\n        isError: true,\n        result: null,\n        error: new Error('JSON.parse error: ' + String(ex)),\n      } as JsonRpcResponseData<T>;\n    }\n\n    const responseData: JsonRpcResponseData<T> = resp.data;\n\n    if (responseData.error) {\n      return {\n        isError: true,\n        result: null,\n        error: new Error(responseData.error.message),\n      } as JsonRpcResponseData<T>;\n    }\n\n    return {\n      isError: false,\n      result: responseData.result as T,\n      error: null,\n    } as JsonRpcResponseData<T>;\n  }\n\n  /**\n   * Sends a post JSON rpc request to the node.\n   *\n   * @param resource - The rpc method to call.\n   * @param params - The parameters to pass to the rpc method.\n   *\n   * @throws An error if the rpc method returns an error.\n   *\n   * @returns A promise that resolves as the result of the rpc method.\n   */\n  protected async sendJsonRPCRequest<T>(\n    resource: JSON_RPC_REQUEST_METHOD,\n    params: object,\n  ): Promise<T> {\n    let resp: JsonRpcResponseData<T> = null;\n    resp = await this.promisifyJsonRpcCall(resource, params);\n\n    // in case of rpc error, rethrow the error.\n    if (resp.error) {\n      throw resp.error;\n    }\n\n    return resp.result;\n  }\n\n  /**\n   * Compacts bytes payload per operation.\n   *\n   * @param data - The operation data.\n   * @param opTypeId - The operation type id.\n   * @param account - The account used.\n   * @param expirePeriod - The expire period.\n   *\n   * @returns The compacted bytes payload.\n   */\n  protected compactBytesForOperation(\n    data: DataType,\n    opTypeId: OperationTypeId,\n    expirePeriod: number,\n  ): Buffer {\n    const feeEncoded = Buffer.from(varintEncode(data.fee));\n    const expirePeriodEncoded = Buffer.from(varintEncode(expirePeriod));\n    const typeIdEncoded = Buffer.from(varintEncode(opTypeId.valueOf()));\n\n    switch (opTypeId) {\n      case OperationTypeId.ExecuteSC: {\n        // get sc data binary\n        const scBinaryCode = (data as IContractData).contractDataBinary;\n\n        // max gas\n        const maxGasEncoded = Buffer.from(\n          varintEncode((data as IContractData).maxGas),\n        );\n\n        // max coins amount\n        const maxCoinEncoded = Buffer.from(\n          varintEncode((data as IContractData).maxCoins),\n        );\n\n        // contract data\n        const contractDataEncoded = Buffer.from(scBinaryCode);\n        const dataLengthEncoded = Buffer.from(\n          varintEncode(contractDataEncoded.length),\n        );\n\n        // smart contract operation datastore\n        const datastoreKeyMap = (data as IContractData).datastore\n          ? (data as IContractData).datastore\n          : new Map<Uint8Array, Uint8Array>();\n        let datastoreSerializedBuffer = Buffer.from(new Uint8Array());\n        for (const [key, value] of datastoreKeyMap) {\n          const encodedKeyBytes = Buffer.from(key);\n          const encodedKeyLen = Buffer.from(\n            varintEncode(encodedKeyBytes.length),\n          );\n          const encodedValueBytes = Buffer.from(value);\n          const encodedValueLen = Buffer.from(\n            varintEncode(encodedValueBytes.length),\n          );\n          datastoreSerializedBuffer = Buffer.concat([\n            datastoreSerializedBuffer,\n            encodedKeyLen,\n            encodedKeyBytes,\n            encodedValueLen,\n            encodedValueBytes,\n          ]);\n        }\n        const datastoreSerializedBufferLen = Buffer.from(\n          varintEncode(datastoreKeyMap.size),\n        );\n        if (datastoreSerializedBuffer.length === 0) {\n          return Buffer.concat([\n            feeEncoded,\n            expirePeriodEncoded,\n            typeIdEncoded,\n            maxGasEncoded,\n            maxCoinEncoded,\n            dataLengthEncoded,\n            contractDataEncoded,\n            datastoreSerializedBufferLen,\n          ]);\n        }\n\n        return Buffer.concat([\n          feeEncoded,\n          expirePeriodEncoded,\n          typeIdEncoded,\n          maxGasEncoded,\n          maxCoinEncoded,\n          dataLengthEncoded,\n          contractDataEncoded,\n          datastoreSerializedBufferLen,\n          datastoreSerializedBuffer,\n        ]);\n      }\n      case OperationTypeId.CallSC: {\n        // max gas\n        const maxGasEncoded = Buffer.from(\n          varintEncode((data as ICallData).maxGas),\n        );\n\n        // coins to send\n        const coinsEncoded = Buffer.from(\n          varintEncode((data as ICallData).coins),\n        );\n\n        // target address\n        const targetAddressEncoded = encodeAddressToBytes(\n          (data as ICallData).targetAddress,\n          true,\n        );\n\n        // target function name and name length\n        const functionNameEncoded = new Uint8Array(\n          Buffer.from((data as ICallData).functionName, 'utf8'),\n        );\n        const functionNameLengthEncoded = Buffer.from(\n          varintEncode(functionNameEncoded.length),\n        );\n\n        // parameter\n        const param = (data as ICallData).parameter;\n        let serializedParam: number[]; // serialized parameter\n        if (param instanceof Array) {\n          serializedParam = param;\n        } else {\n          serializedParam = param.serialize();\n        }\n        const parametersEncoded = new Uint8Array(serializedParam);\n        const parametersLengthEncoded = Buffer.from(\n          varintEncode(parametersEncoded.length),\n        );\n\n        return Buffer.concat([\n          feeEncoded,\n          expirePeriodEncoded,\n          typeIdEncoded,\n          maxGasEncoded,\n          coinsEncoded,\n          targetAddressEncoded,\n          functionNameLengthEncoded,\n          functionNameEncoded,\n          parametersLengthEncoded,\n          parametersEncoded,\n        ]);\n      }\n      case OperationTypeId.Transaction: {\n        // transfer amount\n        const amount = (data as ITransactionData).amount;\n        const transferAmountEncoded = Buffer.from(varintEncode(amount));\n        // recipient\n        const recipientAddressEncoded = encodeAddressToBytes(\n          (data as ITransactionData).recipientAddress,\n          false,\n        );\n\n        return Buffer.concat([\n          feeEncoded,\n          expirePeriodEncoded,\n          typeIdEncoded,\n          recipientAddressEncoded,\n          transferAmountEncoded,\n        ]);\n      }\n      case OperationTypeId.RollBuy:\n      case OperationTypeId.RollSell: {\n        // rolls amount\n        const rollsAmountEncoded = Buffer.from(\n          varintEncode((data as IRollsData).amount),\n        );\n\n        return Buffer.concat([\n          feeEncoded,\n          expirePeriodEncoded,\n          typeIdEncoded,\n          rollsAmountEncoded,\n        ]);\n      }\n    }\n  }\n}\n"]}